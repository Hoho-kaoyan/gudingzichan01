# 批量导入教程

本教程介绍如何通过 Excel 批量导入**用户**和**资产**数据。请严格按照格式准备 Excel 文件，以保证导入成功。

---

## 一、批量导入用户

### 1. 功能入口
- 进入前端页面 `用户管理`
- 点击右上角的 **“批量导入”** 按钮
- 选择 Excel 文件上传

### 2. Excel 格式要求
| 列名 | 必填 | 说明 |
|------|------|------|
| EHR号 | 是 | **7位数字**，用户唯一标识 |
| 姓名 | 是 | 用户真实姓名 |
| 组别 | 是 | 如“第1组”“管理组” |
| 角色 | 否 | `user`（默认）或 `admin` |
| 密码 | 否 | 默认为 `123456` |

**示例：**
| EHR号 | 姓名 | 组别 | 角色 | 密码 |
|-------|------|------|------|------|
| 1234567 | 张三 | 第1组 | user | 123456 |
| 7654321 | 李四 | 管理组 | admin | admin@2024 |

### 3. 验证逻辑
- EHR号必须是 7 位数字，且不能重复
- 未填写的字段按默认值处理
- 若某行数据出错，系统会跳过该行并给出错误说明

---

## 二、批量导入资产

### 1. 功能入口
- 进入前端页面 `资产管理`
- 点击 **“批量导入”** 按钮（仅管理员可用）
- 选择 Excel 文件上传

### 2. Excel 格式要求
| 列名 | 必填 | 说明 |
|------|------|------|
| 资产编号 | 是 | 唯一标识，如 ASSET001 |
| 所属大类 | 是 | 如 “办公用品”“电子设备配件” |
| 实物名称 | 是 | 如 “显示器”“主机” |
| 规格型号 | 否 | 例如 “24寸/IPS” |
| 状态 | 否 | `在用`（默认）或 `库存备用` |
| MAC地址 | 否 | 设备 MAC |
| IP地址 | 否 | 设备 IP |
| 存放办公地点 | 否 | 如 "总部A座" |
| 存放楼层 | 否 | 如 "3F" |
| 座位号 | 否 | 如 "A-101" |
| 使用人EHR号 | 否 | 对应用户的 EHR 号 |
| 使用人组别 | 否 | 默认取使用人所在组别 |
| 备注说明 | 否 | 资产相关备注信息 |

**示例：**
| 资产编号 | 所属大类 | 实物名称 | 规格型号 | 状态 | MAC地址 | IP地址 | 存放办公地点 | 存放楼层 | 座位号 | 使用人EHR号 | 使用人组别 | 备注说明 |
|----------|----------|----------|----------|------|---------|--------|--------------|-----------|--------|--------------|--------------|----------|
| ASSET001 | 办公用品 | 显示器 | 24寸/IPS | 在用 | 00:11:22:33:44:55 | 192.168.1.10 | 总部A座 | 3F | A-101 | 1234567 | 第1组 | 备用显示器 |
| ASSET002 | 电子设备配件 | 主机 | i5-12400 | 库存备用 | | | 仓库 | 1F | | | | 待分配 |

### 3. 验证逻辑
- 资产编号不能重复
- 若使用人 EHR 号存在，则会自动匹配用户，并在未提供组别时填入该用户组别
- 如果大类不存在，系统会自动创建
- 导入过程中若出现错误，会记录到错误列表中返回（最多50条）

---

## 三、使用建议与常见问题

1. **模板建议**：可先导出一份模板，或参考上方示例格式创建 Excel。
2. **编码格式**：请使用 Excel (`.xlsx` 或 `.xls`) 格式，避免 CSV/Numbers。
3. **批量导入权限**：
   - 用户导入：仅管理员可操作
   - 资产导入：仅管理员可操作
4. **导入失败排查**：
   - 查看前端提示中返回的错误信息
   - 检查是否存在重复编号、格式错误等问题
5. **大批量数据**：建议分批导入，便于定位错误。

如需更多帮助，请联系管理员或查阅 `README.md`、`FEATURES.md`。



