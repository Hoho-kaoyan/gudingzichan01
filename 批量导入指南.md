# 批量导入教程

本教程介绍如何通过 Excel 批量导入**用户**和**资产**数据。请严格按照格式准备 Excel 文件，以保证导入成功。

---

## 一、批量导入用户

### 1. 功能入口
- 进入前端页面 `用户管理`
- 点击右上角的 **"批量导入"** 按钮
- 选择 Excel 文件上传

### 2. Excel 格式要求
| 列名 | 必填 | 说明 |
|------|------|------|
| EHR号 | 是 | **7位数字**，用户唯一标识 |
| 姓名 | 是 | 用户真实姓名 |
| 组别 | 是 | 如"第1组""管理组" |
| 角色 | 否 | `user`（默认）或 `admin` |
| 密码 | 否 | 默认为 `123456` |

**示例：**
| EHR号 | 姓名 | 组别 | 角色 | 密码 |
|-------|------|------|------|------|
| 1234567 | 张三 | 第1组 | user | 123456 |
| 7654321 | 李四 | 管理组 | admin | admin@2024 |

### 3. 验证逻辑
- EHR号必须是 7 位数字，且不能重复
- 未填写的字段按默认值处理
- 若某行数据出错，系统会跳过该行并给出错误说明

---

## 二、批量导入资产

### 1. 功能入口
- 进入前端页面 `资产管理`
- 点击 **"批量导入"** 按钮（仅管理员可用）
- 选择 Excel 文件上传

### 2. Excel 格式要求

#### 必填列
| 列名 | 说明 |
|------|------|
| 资产编号 | 唯一标识，如 ASSET001 |
| 所属大类 | 如 "办公用品""电子设备配件" |
| 实物名称 | 如 "显示器""主机" |

#### 可选列
| 列名 | 说明 | 默认值 |
|------|------|--------|
| 规格型号 | 例如 "24寸/IPS" | 空 |
| 状态 | `在用` 或 `库存备用` | `在用` |
| MAC地址 | 设备 MAC 地址 | 空 |
| IP地址 | 设备 IP 地址 | 空 |
| 存放办公地点 | 如 "总部A座" | 空 |
| 存放楼层 | 如 "3F" | 空 |
| 座位号 | 如 "A-101" | 空 |
| 使用人EHR号 | 对应用户的 EHR 号 | 空 |
| 使用人组别 | 使用人所在组别 | 自动从用户信息获取 |
| 备注说明 | 资产相关备注信息 | 空 |

**注意：** 列名支持两种写法：
- `使用人组别` 或 `组别`（两种都可以）

**示例：**
| 资产编号 | 所属大类 | 实物名称 | 规格型号 | 状态 | MAC地址 | IP地址 | 存放办公地点 | 存放楼层 | 座位号 | 使用人EHR号 | 使用人组别 | 备注说明 |
|----------|----------|----------|----------|------|---------|--------|--------------|-----------|--------|------------|-----------|----------|
| ASSET001 | 办公用品 | 显示器 | 24寸/IPS | 在用 | 00:11:22:33:44:55 | 192.168.1.10 | 总部A座 | 3F | A-101 | 1234567 | 第1组 | 备用显示器 |
| ASSET002 | 电子设备配件 | 主机 | i5-12400 | 库存备用 | | | 仓库 | 1F | | | | 待分配 |

### 3. 验证逻辑
- 资产编号不能重复（只检查未删除的资产）
- 若使用人 EHR 号存在，则会自动匹配用户，并在未提供组别时填入该用户组别
- 如果大类不存在，系统会自动创建
- 导入过程中若出现错误，会记录到错误列表中返回（最多50条）

### 4. 导入结果
导入完成后，系统会显示：
- 成功导入的数量
- 失败的数量
- 错误详情列表（最多显示50条）

---

## 三、使用建议与常见问题

### 1. 模板建议
- 可先导出一份模板，或参考上方示例格式创建 Excel
- 建议使用 Excel (`.xlsx` 或 `.xls`) 格式，避免 CSV/Numbers

### 2. 批量导入权限
- **用户导入**：仅管理员可操作
- **资产导入**：仅管理员可操作

### 3. 导入失败排查
- 查看前端提示中返回的错误信息
- 检查是否存在重复编号、格式错误等问题
- 确认必填列是否存在且格式正确
- 检查使用人 EHR 号是否在系统中存在

### 4. 大批量数据
- 建议分批导入，便于定位错误
- 单次导入建议不超过 1000 条记录

### 5. 字段说明

#### 资产状态
- `在用`：资产正在使用中
- `库存备用`：资产在仓库中，未分配使用

#### 座位号
- 用于标识资产的具体位置
- 格式自由，如 "A-101"、"3F-201" 等

#### 备注说明
- 可填写资产的额外信息
- 如 "备用显示器"、"待维修" 等

### 6. 常见错误

| 错误信息 | 原因 | 解决方法 |
|---------|------|---------|
| Excel文件缺少必需的列 | 缺少必填列 | 检查列名是否正确 |
| 资产编号已存在 | 编号重复 | 修改资产编号 |
| 使用人EHR号不存在 | EHR号不在系统中 | 先导入用户或修改EHR号 |
| 第X行：XXX | 该行数据格式错误 | 检查该行数据格式 |

---

## 四、导入流程示例

### 用户导入流程
1. 准备 Excel 文件，包含 EHR号、姓名、组别等列
2. 登录系统（管理员账户）
3. 进入"用户管理"页面
4. 点击"批量导入"按钮
5. 选择 Excel 文件并上传
6. 查看导入结果，处理错误信息

### 资产导入流程
1. 准备 Excel 文件，包含资产编号、所属大类、实物名称等必填列
2. 确保资产大类已存在（或系统会自动创建）
3. 确保使用人 EHR 号已存在（如果填写了使用人）
4. 登录系统（管理员账户）
5. 进入"资产管理"页面
6. 点击"批量导入"按钮
7. 选择 Excel 文件并上传
8. 查看导入结果，处理错误信息

---

如需更多帮助，请联系管理员或查阅 `README.md`、`功能模块说明.md`。
